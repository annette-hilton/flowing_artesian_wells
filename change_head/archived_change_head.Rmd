---
title: "Change in Head by Aquifer System"
author: "Annette Hilton"
date: '2023-06-05'
output:
  word_document: default
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Attach Packages

```{r}
# Attach packages 

library(tidyverse)
library(here)
library(janitor)
library(dplyr)
library(knitr)


# Disable scientific notation 

options(scipen=999)
```

# Read in data 

- By each regional aquifer system that you can analyze based on criteria (n=25 samples)
- Data that has already been sorted in aquifer unit, contains DEM information 
- Regional aquifer systems include: 
  - Mississippi Embayment
  - North Atlantic Coastal Plain 
  - Central Valley 
  - Dakota Aquifer System
  - Floridan 
  - Houston-Gulf Coast 
  - Roswell 

## Criteria for analysis 

Regional systems will be examined by aquifer unit. 
Each aquifer unit must have at least n=25 wells in both the pre-1910 and post-2010 time periods 


### Mississippi Embayment 

```{r}
# Pre-1910 clean file 

early1900s_me <- read_tsv(here::here("change_head", "data", "1900s_me.txt"))

# Modern 2010-2022 clean file 

modern_me <- read_tsv(here::here("change_head", "data", "modern_me.txt"))
```

##### Aquifer units to analyze in ME: 

- Middle Claiborne aquifer 
- Lower Claiborne confining unit 

#### Middle Claiborne Aquifer

Post-2010 data 

```{r}
# Subtract median water level from topography to get the real water level 

modern_head_me <- modern_me %>% 
  mutate(head = topo_ft - median)

# Keep only records in the mcaq, that are confined, and what we used in our regional analysis 

mca_mod <- modern_head_me %>% 
  filter(aquifer == "mcaq") %>% 
  filter(status == "confined") %>% 
  filter(!grepl("Unconfined single aquifer", code))

# Final summaries 

mca_mod_head <- mca_mod %>%  
  dplyr::summarise(
    min = min(head), 
    max = max(head), 
    quantile = quantile(head),
    mean = mean(head), 
    median = median(head),
    standard_deviation = sd(head)
    )

```

```{r echo = FALSE, results = 'asis'}

# Display knitted table 

kable(mca_mod_head, caption = "Table 1. Mississippi Embayment, head of Middle Claiborne aquifer summary statistics for Post-2010")
```

```{r}
# Histogram 

Head_2010 <- mca_mod$head

hist(Head_2010,
     main="Hydraulic Head Post-2010",
     xlab="Hydraulic Head (ft)",
     xlim=c(-200, 400))
```

Pre-1910 data 

```{r}
# The DEM of the artesian flowing wells will be used as minimum head 

# Keep only records in the mcaq, that are confined, artesian, and what we used in our regional analysis

mca_1900s <- early1900s_me %>% 
  filter(aquifer == "mcaq") %>% 
  filter(status == "confined") %>%
  filter(artesian == 1)


# Final summaries 

mca_1900_head <- mca_1900s %>%  
  dplyr::summarise(
    min = min(topo_ft), 
    max = max(topo_ft), 
    quantile = quantile(topo_ft),
    mean = mean(topo_ft), 
    median = median(topo_ft),
    standard_deviation = sd(topo_ft)
    )
```

```{r echo = FALSE, results = 'asis'}

# Display knitted table 

kable(mca_1900_head, caption = "Table 1. Mississippi Embayment, head of Middle Claiborne aquifer summary statistics for Pre-1910 (artesian values only), n=47")
```


```{r}
# Histogram 

Head_1900s <- mca_1900s$topo_ft

hist(Head_1900s, 
     main="Head Pre-1910 (Topography Proxy/Artesian Only)",
     xlab="Hydraulic Head (ft)",
     xlim=c(-200, 400))

```

TEST--use all water levels (if available) 

```{r}
# The DEM of the artesian flowing wells will be used as minimum head 

allmca_1900s <- early1900s_me %>% 
  filter(aquifer == "mcaq") %>% 
  filter(status == "confined") %>% 
  mutate(non_art_head = topo_ft - abs(water_level_ft)) %>% 
  mutate(head = ifelse(artesian == 1, topo_ft, non_art_head)) %>% 
  select(-vkbg_surf_1:-mdwy_surf_1)

# Final summaries 

all_mca_1900_head <- allmca_1900s %>%  
  dplyr::summarise(
    min = min(head), 
    max = max(head), 
    quantile = quantile(head),
    mean = mean(head), 
    median = median(head),
    standard_deviation = sd(head)
    )
```

```{r echo = FALSE, results = 'asis'}

# Display knitted table 

kable(all_mca_1900_head, caption = "Table 1. Mississippi Embayment, head of Middle Claiborne aquifer summary statistics for Pre-1910 (All values), n=136")
```

```{r}
# Histogram 

Head_1900s_all <- allmca_1900s$head

hist(Head_1900s_all, 
     main="Hydraulic Head Pre-1910 (All Values)",
     xlab="Hydraulic Head (ft)",
     xlim=c(-200, 400))

```

