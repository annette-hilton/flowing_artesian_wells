---
title: "NACP Project--Well Classification"
author: "Annette Hilton"
date: "05/03/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, error = FALSE)
```

# Introduction

This project is an examination of early 1900s (~1890-1906) groundwater conditions in the North Atlantic Coastal Plain (NACP) as compared to present day (2010-2021).

The purpose of this Rmd is to:

1)  Determine well-aquifer classification
2)  Compare artesian conditions
  

## Attach Packages and Data 

```{r}
# Attach packages 

library(plyr) # Be sure to load `plyr()` first, otherwise other functions in tidyverse break! 
library(tidyverse)
library(here)
library(janitor)
library(naniar)
library(data.table)

# Disable scientific notation 

options(scipen=999)
```
## ArcGIS Data Analysis

The following steps were performed in ArcGIS:

Hydrogeological data: Arcfile = "nacp_classify" (ArcPro)

1.  Hydrogeologic layers (raster files)
2.  Modern wells from ME (USGS) (processed in Rmd
    `modern_data_cleaning.Rmd`) and early 1900s data
    (early1900s_dem_wgs84_final.txt)
3.  Use tool "Extract multi values to points" to determine well location
    intersection with geological raster layers
4.  Export resulting well data as a text files


### Hydrogeological data 

```{r}
# Read in modern data file from Arc 
# Rename columns 

nacp_mod_fromarc <- readr::read_csv(here::here("data", "nacp", "nacp_modern_classify.txt")) %>% 
  clean_names() %>% 
  rename(nacp_aq01s = nacp_aq01surf_1,
         nacp_cu01 = nacp_cu01_1, 
         nacp_aq02u = nacp_aq02upch_1, 
         nacp_cu02 = nacp_cu02_1, 
         nacp_aq03l = nacp_aq03loch_1,
         nacp_cu03 = nacp_cu03_1, 
         nacp_aq04p = nacp_aq04pipt_1, 
         nacp_cu04 = nacp_cu04_1, 
         nacp_aq05a = nacp_aq05aq_1, 
         nacp_cu05 = nacp_cu05_1, 
         nacp_aq06m = nacp_aq06moml_1,
         nacp_cu06 = nacp_cu06_1, 
         nacp_aq07m = nacp_aq07mtwn_1, 
         nacp_cu07 = nacp_cu07_1, 
         nacp_aq08m = nacp_aq08mgty_1, 
         nacp_cu08 = nacp_cu08_1, 
         nacp_aq09p = nacp_aq09popt_1, 
         nacp_cu09 = nacp_cu09_1, 
         nacp_aq10p = nacp_aq10popx_1, 
         nacp_cu10b = nacp_cu10bsmt_1)

# Read in early 1900s data file from Arc 
# Rename columns 

nacp_early1900s_fromarc <- readr::read_csv(here::here("data", "nacp", "nacp_1900s_classify.txt")) %>% 
  clean_names() %>% 
  rename(nacp_aq01s = nacp_aq01surf, 
         nacp_aq02u = nacp_aq02upch, 
         nacp_aq03l = nacp_aq03loch, 
         nacp_aq04p = nacp_aq04pipt, 
         nacp_aq05a = nacp_aq05aq, 
         nacp_aq06m = nacp_aq06moml, 
         nacp_aq07m = nacp_aq07mtwn, 
         nacp_aq08m = nacp_aq08mgty, 
         nacp_aq09p = nacp_aq09popt, 
         nacp_aq10p = nacp_aq10popx, 
         nacp_cu10b = nacp_cu10bsmt)

```

### NACP Aquifer Information 

Hydrogeologic Layer Surfaces:

- Surficial aquifer (nacp_aq01_surf) == (nacp_aq01s)
- Upper Chesapeake confining unit (nacp_cu01)
- Upper Chesapeake aquifer (nacp_aq02upch) == (nacp_aq02u)
- Lower Chesapeake confining unit (nacp_cu02)
- Lower Chesapeake aquifer (nacp_aq03loch) == (nacp_aq03l)
- Calvert confining unit (nacp_cu03)
- Piney Point aquifer (nacp_aq04pipt) == (nacp_aq04p)
- Nanjemoy-Marlboro confining unit (nacp_cu04)
- Aquia aquifer (nacp_aq05aq) == (nacp_aq05a)
- Monmouth-Mount Laurel confining unit (nacp_cu05)
- Monmouth-Mount Laurel aquifer (nacp_aq06moml) == (nacp_aq06m)
- Matawan confining unit (nacp_cu06)
- Matawan aquifer (nacp_aq07mtwn) == (nacp_aq07m)
- Magothy confining unit (nacp_cu07)
- Magothy aquifer (nacp_aq08mgty) == (nacp_aq08m)
- Potomac confining unit (nacp_cu08)
- Potomac-Patapsco aquifer (nacp_aq09popt) == (nacp_aq09p)
- Potomac-Patuxent confining unit (nacp_cu09)
- Potomac-Patuxent aquifer (nacp_aq10_popx) == (nacp_aq10_p)
- Basement (nacp_cu10bsmt) == (nacp_cu10b)

Unit Range (ft): 

- Surficial aquifer: 481 (-308)
- Upper Chesapeake confining unit: 129 (-354) 
- Upper Chesapeake aquifer: 114 (-383)
- Lower Chesapeake confining unit: 150 (-850)
- Lower Chesapeake aquifer: 215 (-1007)
- Calvert confining unit: 236 (-1671)
- Piney Point aquifer: 92 (-1516)
- Nanjemoy-Marlboro confining unit: 233 (-1720)
- Aquia aquifer: 228 (-1323)
- Monmouth-Mount Laurel confining unit: 214 (-1981) 
- Monmouth-Mount Laurel aquifer: 143 (-2377) 
- Matawan confining unit: 118 (-2439)
- Matawan aquifer: 62 (-2501) 
- Magothy confining unit: 130 (-2532) 
- Magothy aquifer: 187 (-2995) 
- Potomac confining unit: 198 (-3380)
- Potomac-Patapsco aquifer: 229 (-3602) 
- Potomac-Patuxent confining unit: 408 (-5373)
- Potomac-Patuxent aquifer: 408 (-5373)
- Basement: 400 (-9031) 


### Aquifer analysis 

- Find well bottom 
- Remove observations that do not fall within NACP (all NAs) 

```{r}
# Add a column that is elevation minus well depth
# Add column to remove rows if nacp_aq01s:nacp_cu10b are all NAs (does not intersect with NACP) 

# Modern data 

nacp_analysis_mod <- nacp_mod_fromarc %>% 
  mutate(topo_ft = rastervalu * 3.28084) %>% 
  mutate(well_bottom = topo_ft - well_depth_va) %>% 
   mutate(keep = 
           ifelse(is.na(nacp_aq01s) & is.na(nacp_cu01) & is.na(nacp_aq02u) 
                  & is.na(nacp_cu02) & is.na(nacp_aq03l) & is.na(nacp_cu03)
                  & is.na(nacp_aq04p) & is.na(nacp_cu04) & is.na(nacp_aq05a)
                  & is.na(nacp_cu05) & is.na(nacp_aq06m) & is.na(nacp_cu06)
                  & is.na(nacp_aq07m) & is.na(nacp_cu07) & is.na(nacp_aq08m)
                  & is.na(nacp_cu08) & is.na(nacp_aq09p) & is.na(nacp_cu09) 
                  & is.na(nacp_aq10p) & is.na(nacp_cu10b), "NA", "keep")) %>% 
  filter(!keep == "NA")

# 1900s data 

nacp_analysis_1900 <- nacp_early1900s_fromarc %>% 
  mutate(topo_ft = ned10m_bilinear_cusa_albers102003 * 3.28084) %>% 
  mutate(well_bottom = topo_ft - well_depth_ft) %>% 
   mutate(keep = 
           ifelse(is.na(nacp_aq01s) & is.na(nacp_cu01) & is.na(nacp_aq02u) 
                  & is.na(nacp_cu02) & is.na(nacp_aq03l) & is.na(nacp_cu03)
                  & is.na(nacp_aq04p) & is.na(nacp_cu04) & is.na(nacp_aq05a)
                  & is.na(nacp_cu05) & is.na(nacp_aq06m) & is.na(nacp_cu06)
                  & is.na(nacp_aq07m) & is.na(nacp_cu07) & is.na(nacp_aq08m)
                  & is.na(nacp_cu08) & is.na(nacp_aq09p) & is.na(nacp_cu09) 
                  & is.na(nacp_aq10p) & is.na(nacp_cu10b), "NA", "keep")) %>% 
  filter(!keep == "NA")
  
```

#### Classify each well to an aquifer unit 

Process: 

If well bottom is greater than second unit (top), then it falls within the first unit (second unit top is the bottom of the first unit). 

Well bottom < nacp_aq01s & well bottom > max(nacp_cu01:nacp_cu10b) = “nacp_aq01s”
Well bottom < nacp_cu01 & well bottom > max(nacp_aq02u:nacp_cu10b) = “nacp_cu01”
Well bottom < nacp_aq02u & well bottom > max(nacp_cu02:nacp_cu10b) = “nacp_aq02u”
Well bottom < nacp_cu02 & well bottom > max(nacp_aq03l:nacp_cu10b) = “nacp_cu02” 
Well bottom < nacp_aq03l & well bottom > max(nacp_cu03:nacp_cu10b) = “nacp_aq03l”
Well bottom < nacp_cu03 & well bottom > max(nacp_aq04p:nacp_cu10b) = “nacp_cu03”
Well bottom < nacp_aq04p & well bottom > max(nacp_cu04:nacp_cu10b) = “nacp_aq04p” 
Well bottom < nacp_cu04 & well bottom > max(nacp_aq05a:nacp_cu10b) = “nacp_cu04” 
Well bottom < nacp_aq05a & well bottom > max(nacp_cu05:nacp_cu10b) = “nacp_aq05a” 
Well bottom < nacp_cu05 & well bottom > max(nacp_aq06m:nacp_cu10b) = “nacp_cu05” 
Well bottom < nacp_aq06m & well bottom > max(nacp_cu06:nacp_cu10b) = “nacp_aq06m” 
Well bottom < nacp_cu06 & well bottom > max(nacp_aq07m:nacp_cu10b) = “nacp_cu06”
Well bottom < nacp_aq07m & well bottom > max(nacp_cu07:nacp_cu10b) = “nacp_aq07m” 
Well bottom < nacp_cu07 & well bottom > max(nacp_aq08m:nacp_cu10b) = “nacp_cu07”
Well bottom < nacp_aq08m & well bottom > max(nacp_cu08:nacp_cu10b) = “nacp_aq08m”  
Well bottom < nacp_cu08 & well bottom > max(nacp_aq09p:nacp_cu10b) = “nacp_cu08”
Well bottom < nacp_aq09p & well bottom > max(nacp_cu09:nacp_cu10b) = “nacp_aq09p”
Well bottom < nacp_cu09 & well bottom > max(nacp_aq10p:nacp_cu10b) = “nacp_cu09”
Well bottom < nacp_aq10p & well bottom > nacp_cu10b = “nacp_aq10p”  
Well bottom < nacp_cu10b = “nacp_cu10b” 



```{r}
# Code for assigning each well to an aquifer unit 
# Not elegant but currently works! 

# Modern data 

nacp_class_mod <- nacp_analysis_mod %>% 
  rowwise() %>%
  mutate(aquifer = 
        ifelse(well_bottom < topo_ft & well_bottom >= max(nacp_cu01, nacp_aq02u, nacp_cu02, 
                                                            nacp_aq03l, nacp_cu03, nacp_aq04p, 
                                                            nacp_cu04, nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "surf", 
        ifelse(well_bottom < nacp_cu01 & well_bottom >= max(nacp_aq02u, nacp_cu02, 
                                                            nacp_aq03l, nacp_cu03, nacp_aq04p, 
                                                            nacp_cu04, nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE),"nacp_cu01",
        ifelse(well_bottom < nacp_aq02u & well_bottom >= max(nacp_cu02, 
                                                            nacp_aq03l, nacp_cu03, nacp_aq04p, 
                                                            nacp_cu04, nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq02u", 
        ifelse(well_bottom < nacp_cu02 & well_bottom >= max(nacp_aq03l, nacp_cu03, nacp_aq04p, 
                                                            nacp_cu04, nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu02",
        ifelse(well_bottom < nacp_aq03l & well_bottom >= max(nacp_cu03, nacp_aq04p, 
                                                            nacp_cu04, nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq03l", 
        ifelse(well_bottom < nacp_cu03 & well_bottom >= max(nacp_aq04p, 
                                                            nacp_cu04, nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu03", 
        ifelse(well_bottom < nacp_aq04p & well_bottom >= max(nacp_cu04, nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq04p",
        ifelse(well_bottom < nacp_cu04 & well_bottom >= max(nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu04",
        ifelse(well_bottom < nacp_aq05a & well_bottom >= max(nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq05a",
        ifelse(well_bottom < nacp_cu05 & well_bottom >= max(nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu05", 
        ifelse(well_bottom < nacp_aq06m & well_bottom >= max(nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq06m",
        ifelse(well_bottom < nacp_cu06 & well_bottom >= max(nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu06",
        ifelse(well_bottom < nacp_aq07m & well_bottom >= max(nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq07m",
        ifelse(well_bottom < nacp_cu07 & well_bottom >= max(nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu07",
        ifelse(well_bottom < nacp_aq08m & well_bottom >= max(nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq08m",
        ifelse(well_bottom < nacp_cu08 & well_bottom >= max(nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu08",
        ifelse(well_bottom < nacp_aq09p & well_bottom >= max(nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq09p",
        ifelse(well_bottom < nacp_cu09 & well_bottom >= max(nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu09",
        ifelse(well_bottom < nacp_aq10p & well_bottom >= nacp_cu10b, "nacp_aq10p",
        ifelse(well_bottom < nacp_cu10b, "nacp_cu10b", NA)))))))))))))))))))))


# 1900 data 
nacp_class_1900 <- nacp_analysis_1900 %>% 
  rowwise() %>%
  mutate(aquifer = 
        ifelse(well_bottom < topo_ft & well_bottom >= max(nacp_cu01, nacp_aq02u, nacp_cu02, 
                                                            nacp_aq03l, nacp_cu03, nacp_aq04p, 
                                                            nacp_cu04, nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "surf", 
        ifelse(well_bottom < nacp_cu01 & well_bottom >= max(nacp_aq02u, nacp_cu02, 
                                                            nacp_aq03l, nacp_cu03, nacp_aq04p, 
                                                            nacp_cu04, nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE),"nacp_cu01",
        ifelse(well_bottom < nacp_aq02u & well_bottom >= max(nacp_cu02, 
                                                            nacp_aq03l, nacp_cu03, nacp_aq04p, 
                                                            nacp_cu04, nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq02u", 
        ifelse(well_bottom < nacp_cu02 & well_bottom >= max(nacp_aq03l, nacp_cu03, nacp_aq04p, 
                                                            nacp_cu04, nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu02",
        ifelse(well_bottom < nacp_aq03l & well_bottom >= max(nacp_cu03, nacp_aq04p, 
                                                            nacp_cu04, nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq03l", 
        ifelse(well_bottom < nacp_cu03 & well_bottom >= max(nacp_aq04p, 
                                                            nacp_cu04, nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu03", 
        ifelse(well_bottom < nacp_aq04p & well_bottom >= max(nacp_cu04, nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq04p",
        ifelse(well_bottom < nacp_cu04 & well_bottom >= max(nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu04",
        ifelse(well_bottom < nacp_aq05a & well_bottom >= max(nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq05a",
        ifelse(well_bottom < nacp_cu05 & well_bottom >= max(nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu05", 
        ifelse(well_bottom < nacp_aq06m & well_bottom >= max(nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq06m",
        ifelse(well_bottom < nacp_cu06 & well_bottom >= max(nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu06",
        ifelse(well_bottom < nacp_aq07m & well_bottom >= max(nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq07m",
        ifelse(well_bottom < nacp_cu07 & well_bottom >= max(nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu07",
        ifelse(well_bottom < nacp_aq08m & well_bottom >= max(nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq08m",
        ifelse(well_bottom < nacp_cu08 & well_bottom >= max(nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu08",
        ifelse(well_bottom < nacp_aq09p & well_bottom >= max(nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq09p",
        ifelse(well_bottom < nacp_cu09 & well_bottom >= max(nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu09",
        ifelse(well_bottom < nacp_aq10p & well_bottom >= nacp_cu10b, "nacp_aq10p",
        ifelse(well_bottom < nacp_cu10b, "nacp_cu10b", NA)))))))))))))))))))))

```


### Separate each aquifer/unit and confined

#### Modern Data

Just confining unit above

```{r}
# Confining unit criteria 
# Must have confining unit above to be considered a confined well 
# Can include confining units (except the uppermost) 

confined_criteria_mod <- nacp_class_mod %>% 
  rowwise() %>% 
  mutate(status = 
           ifelse(is.na(aquifer), NA,
           ifelse(aquifer %in% c("surf", "nacp_cu01"), "unconfined", 
           ifelse(aquifer == "nacp_aq02u" & is.na(nacp_cu01), "unconfined",
           ifelse(aquifer == "nacp_cu02" & is.na(nacp_cu01), "unconfined", 
           ifelse(aquifer == "nacp_aq03l" & !is.na(nacp_cu01) | !is.na(nacp_cu02), "confined",
           ifelse(aquifer == "nacp_cu03" & !is.na(nacp_cu01) | !is.na(nacp_cu02), "confined",
           ifelse(aquifer == "nacp_aq04p" & !is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03), "confined",
           ifelse(aquifer == "nacp_cu04" & !is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03), "confined", 
           ifelse(aquifer == "nacp_aq05a" & !is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) |
                    !is.na(nacp_cu04), "confined", 
           ifelse(aquifer == "nacp_cu05" & !is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) |
                    !is.na(nacp_cu04), "confined", 
           ifelse(aquifer == "nacp_aq06m" & !is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) |
                    !is.na(nacp_cu04) | !is.na(nacp_cu05), "confined",
           ifelse(aquifer == "nacp_cu06" & !is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) |
                    !is.na(nacp_cu04) | !is.na(nacp_cu05), "confined", 
           ifelse(aquifer == "nacp_aq07m" & !is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) |
                    !is.na(nacp_cu04) | !is.na(nacp_cu05) | !is.na(nacp_cu06), "confined",
           ifelse(aquifer == "nacp_cu07" & !is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) |
                    !is.na(nacp_cu04) | !is.na(nacp_cu05) | !is.na(nacp_cu06), "confined",
           ifelse(aquifer == "nacp_aq08m" & !is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) |
                    !is.na(nacp_cu04) | !is.na(nacp_cu05) | !is.na(nacp_cu06) | !is.na(nacp_cu07), "confined",
           ifelse(aquifer == "nacp_cu08" & !is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) |
                    !is.na(nacp_cu04) | !is.na(nacp_cu05) | !is.na(nacp_cu06) | !is.na(nacp_cu07), "confined",
           ifelse(aquifer == "nacp_aq09p" & !is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) |
                    !is.na(nacp_cu04) | !is.na(nacp_cu05) | !is.na(nacp_cu06) | !is.na(nacp_cu07) 
                   |!is.na(nacp_cu08), "confined",
           ifelse(aquifer == "nacp_cu09" & !is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) |
                    !is.na(nacp_cu04) | !is.na(nacp_cu05) | !is.na(nacp_cu06) | !is.na(nacp_cu07) 
                   |!is.na(nacp_cu08), "confined",
           ifelse(aquifer == "nacp_aq10_p" & !is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) |
                    !is.na(nacp_cu04) | !is.na(nacp_cu05) | !is.na(nacp_cu06) | !is.na(nacp_cu07) 
                   |!is.na(nacp_cu08) | !is.na(nacp_cu09), "confined",
           ifelse(aquifer == "nacp_cu10b" & !is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) |
                    !is.na(nacp_cu04) | !is.na(nacp_cu05) | !is.na(nacp_cu06) | !is.na(nacp_cu07) 
                   |!is.na(nacp_cu08) | !is.na(nacp_cu09), "confined",
                  "unconfined")))))))))))))))))))))

confined_criteria_mod1 <- nacp_class_mod %>% 
  rowwise() %>% 
  mutate(status = 
           ifelse(is.na(aquifer), NA,
           ifelse(aquifer %in% c("surf", "nacp_cu01"), "unconfined", 
           ifelse(aquifer == "nacp_aq02u" & !is.na(nacp_cu01), "confined",
           ifelse(aquifer == "nacp_cu02" & !is.na(nacp_cu01), "confined", 
           ifelse(aquifer == "nacp_aq03l" & is.na(nacp_cu01) | is.na(nacp_cu02), "unconfined",
           ifelse(aquifer == "nacp_cu03" & is.na(nacp_cu01) | is.na(nacp_cu02), "unconfined",
           ifelse(aquifer == "nacp_aq04p" & is.na(nacp_cu01) | is.na(nacp_cu02) | is.na(nacp_cu03), "unconfined",
           ifelse(aquifer == "nacp_cu04" & is.na(nacp_cu01) | is.na(nacp_cu02) | is.na(nacp_cu03), "unconfined", 
           ifelse(aquifer == "nacp_aq05a" & is.na(nacp_cu01) | is.na(nacp_cu02) | is.na(nacp_cu03) |
                    is.na(nacp_cu04), "unconfined", 
           ifelse(aquifer == "nacp_cu05" & is.na(nacp_cu01) | is.na(nacp_cu02) | is.na(nacp_cu03) |
                    is.na(nacp_cu04), "unconfined", 
           ifelse(aquifer == "nacp_aq06m" & is.na(nacp_cu01) | is.na(nacp_cu02) | is.na(nacp_cu03) |
                    is.na(nacp_cu04) | is.na(nacp_cu05), "unconfined",
           ifelse(aquifer == "nacp_cu06" & is.na(nacp_cu01) | is.na(nacp_cu02) | is.na(nacp_cu03) |
                    is.na(nacp_cu04) | is.na(nacp_cu05), "unconfined", 
           ifelse(aquifer == "nacp_aq07m" & is.na(nacp_cu01) | is.na(nacp_cu02) | is.na(nacp_cu03) |
                    is.na(nacp_cu04) | is.na(nacp_cu05) | is.na(nacp_cu06), "unconfined",
           ifelse(aquifer == "nacp_cu07" & is.na(nacp_cu01) | is.na(nacp_cu02) | is.na(nacp_cu03) |
                    is.na(nacp_cu04) | is.na(nacp_cu05) | is.na(nacp_cu06), "unconfined",
           ifelse(aquifer == "nacp_aq08m" & is.na(nacp_cu01) | is.na(nacp_cu02) | is.na(nacp_cu03) |
                    is.na(nacp_cu04) | is.na(nacp_cu05) | is.na(nacp_cu06) | is.na(nacp_cu07), "unconfined",
           ifelse(aquifer == "nacp_cu08" & is.na(nacp_cu01) | is.na(nacp_cu02) | is.na(nacp_cu03) |
                    is.na(nacp_cu04) | is.na(nacp_cu05) | is.na(nacp_cu06) | is.na(nacp_cu07), "unconfined",
           ifelse(aquifer == "nacp_aq09p" & is.na(nacp_cu01) | is.na(nacp_cu02) | is.na(nacp_cu03) |
                    is.na(nacp_cu04) | is.na(nacp_cu05) | is.na(nacp_cu06) | is.na(nacp_cu07) 
                   |is.na(nacp_cu08), "unconfined",
           ifelse(aquifer == "nacp_cu09" & is.na(nacp_cu01) | is.na(nacp_cu02) | is.na(nacp_cu03) |
                    is.na(nacp_cu04) | is.na(nacp_cu05) | is.na(nacp_cu06) | is.na(nacp_cu07) 
                   |is.na(nacp_cu08), "unconfined",
           ifelse(aquifer == "nacp_aq10_p" & is.na(nacp_cu01) | is.na(nacp_cu02) | is.na(nacp_cu03) |
                    is.na(nacp_cu04) | is.na(nacp_cu05) | is.na(nacp_cu06) | is.na(nacp_cu07) 
                   |is.na(nacp_cu08) | is.na(nacp_cu09), "unconfined",
           ifelse(aquifer == "nacp_cu10b" & is.na(nacp_cu01) | is.na(nacp_cu02) | is.na(nacp_cu03) |
                    is.na(nacp_cu04) | is.na(nacp_cu05) | is.na(nacp_cu06) | is.na(nacp_cu07) 
                   |is.na(nacp_cu08) | is.na(nacp_cu09), "unconfined",
                  "confined")))))))))))))))))))))

#fifelse 

confined_criteria_mod3 <- nacp_class_mod %>% 
  rowwise() %>% 
  mutate(status = 
           fifelse(aquifer %in% c("surf", "nacp_cu01"), "topunconfined", 
           fifelse(aquifer == "nacp_aq02u" & is.na(nacp_cu01), "unconfined",
           fifelse(aquifer == "nacp_cu02" & is.na(nacp_cu01), "unconfined", 
           fifelse(aquifer == "nacp_aq03l" & !is.na(nacp_cu01) | !is.na(nacp_cu02), "1confined",
           fifelse(aquifer == "nacp_cu03" & !is.na(nacp_cu01) | !is.na(nacp_cu02), "2confined",
           fifelse(aquifer == "nacp_aq04p" & !is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03), "3confined",
           fifelse(aquifer == "nacp_cu04" & !is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03), "4confined", 
           fifelse(aquifer == "nacp_aq05a" & !is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) |
                    !is.na(nacp_cu04), "5confined", 
           fifelse(aquifer == "nacp_cu05" & !is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) |
                    !is.na(nacp_cu04), "6confined", 
           fifelse(aquifer == "nacp_aq06m" & !is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) |
                    !is.na(nacp_cu04) | !is.na(nacp_cu05), "7confined",
           fifelse(aquifer == "nacp_cu06" & !is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) |
                    !is.na(nacp_cu04) | !is.na(nacp_cu05), "8confined", 
           fifelse(aquifer == "nacp_aq07m" & !is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) |
                    !is.na(nacp_cu04) | !is.na(nacp_cu05) | !is.na(nacp_cu06), "9confined",
           fifelse(aquifer == "nacp_cu07" & !is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) |
                    !is.na(nacp_cu04) | !is.na(nacp_cu05) | !is.na(nacp_cu06), "10confined",
           fifelse(aquifer == "nacp_aq08m" & !is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) |
                    !is.na(nacp_cu04) | !is.na(nacp_cu05) | !is.na(nacp_cu06) | !is.na(nacp_cu07), "11confined",
           fifelse(aquifer == "nacp_cu08" & !is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) |
                    !is.na(nacp_cu04) | !is.na(nacp_cu05) | !is.na(nacp_cu06) | !is.na(nacp_cu07), "12confined",
           fifelse(aquifer == "nacp_aq09p" & !is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) |
                    !is.na(nacp_cu04) | !is.na(nacp_cu05) | !is.na(nacp_cu06) | !is.na(nacp_cu07) 
                   |!is.na(nacp_cu08), "13confined",
           fifelse(aquifer == "nacp_cu09" & !is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) |
                    !is.na(nacp_cu04) | !is.na(nacp_cu05) | !is.na(nacp_cu06) | !is.na(nacp_cu07) 
                   |!is.na(nacp_cu08), "14confined",
           fifelse(aquifer == "nacp_aq10_p" & !is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) |
                    !is.na(nacp_cu04) | !is.na(nacp_cu05) | !is.na(nacp_cu06) | !is.na(nacp_cu07) 
                   |!is.na(nacp_cu08) | !is.na(nacp_cu09), "15confined",
           fifelse(aquifer == "nacp_cu10b" & !is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) |
                    !is.na(nacp_cu04) | !is.na(nacp_cu05) | !is.na(nacp_cu06) | !is.na(nacp_cu07) 
                   |!is.na(nacp_cu08) | !is.na(nacp_cu09), "16confined",
                  "finalunconfined", na = NA))))))))))))))))))))

# case_when 

#fifelse 

confined_criteria_mod4 <- nacp_class_mod %>% 
  rowwise() %>% 
  mutate(status = 
           case_when(aquifer %in% c("surf", "nacp_cu01") ~"topunconfined",
                     aquifer == "nacp_aq02u" & !is.na(nacp_cu01) ~"2confined",
                      aquifer == "nacp_cu02" & !is.na(nacp_cu01) ~"cu2confined", 
                      aquifer == "nacp_aq03l" & (!is.na(nacp_cu01) | !is.na(nacp_cu02)) ~"3confined",
                      aquifer == "nacp_cu03" & (!is.na(nacp_cu01) | !is.na(nacp_cu02)) ~"cu3confined",
                      aquifer == "nacp_aq04p" & (!is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03)) ~"4confined",
                      aquifer == "nacp_cu04" & (!is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03)) ~"cu4confined", 
                      aquifer == "nacp_aq05a" & (!is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) | !is.na(nacp_cu04)) ~"5confined", 
                      aquifer == "nacp_cu05" & (!is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) | !is.na(nacp_cu04)) ~"cu5confined", 
                      aquifer == "nacp_aq06m" & (!is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) | !is.na(nacp_cu04) | !is.na(nacp_cu05)) ~"6confined",
                      aquifer == "nacp_cu06" & (!is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03)  | !is.na(nacp_cu04) | !is.na(nacp_cu05)) ~"cu6confined", 
                      aquifer == "nacp_aq07m" & (!is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) | !is.na(nacp_cu04) | !is.na(nacp_cu05) | !is.na(nacp_cu06)) ~"7confined",
                      aquifer == "nacp_cu07" & (!is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) | !is.na(nacp_cu04) | !is.na(nacp_cu05) | !is.na(nacp_cu06)) ~"cu7confined",
                      aquifer == "nacp_aq08m" & (!is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) | !is.na(nacp_cu04) | !is.na(nacp_cu05) | !is.na(nacp_cu06) | !is.na(nacp_cu07)) ~"8confined",
                      aquifer == "nacp_cu08" & (!is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) | !is.na(nacp_cu04) | !is.na(nacp_cu05) | !is.na(nacp_cu06) | !is.na(nacp_cu07)) ~"cu8confined",
                      aquifer == "nacp_aq09p" & (!is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) | !is.na(nacp_cu04) | !is.na(nacp_cu05) | !is.na(nacp_cu06) | !is.na(nacp_cu07) |!is.na(nacp_cu08)) ~"9confined",
                      aquifer == "nacp_cu09" & (!is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) | !is.na(nacp_cu04) | !is.na(nacp_cu05) | !is.na(nacp_cu06) | !is.na(nacp_cu07) |!is.na(nacp_cu08)) ~"cu9confined",
                      aquifer == "nacp_aq10p" & (!is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) | !is.na(nacp_cu04) | !is.na(nacp_cu05) | !is.na(nacp_cu06) | !is.na(nacp_cu07) 
                                  |!is.na(nacp_cu08) | !is.na(nacp_cu09)) ~"10confined",
                      aquifer == "nacp_cu10b" & (!is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03) | !is.na(nacp_cu04) | !is.na(nacp_cu05) | !is.na(nacp_cu06) | !is.na(nacp_cu07) 
                                  |!is.na(nacp_cu08) | !is.na(nacp_cu09)) ~"cu10confined", TRUE ~"finalunconfined"))


test_halp <- nacp_class_mod %>% 
  rowwise() %>% 
  mutate(testing = 
           ifelse(aquifer == "nacp_aq03l" & is.na(nacp_cu01) | is.na(nacp_cu02), "confined", 
                  ifelse(aquifer == "nacp_cu03" & !is.na(nacp_cu01) | !is.na(nacp_cu02),
                                 "confined", 
                  ifelse(aquifer == "nacp_aq04p" & !is.na(nacp_cu01) | !is.na(nacp_cu02) | !is.na(nacp_cu03), "confined", "unconfined"))))



confining_units <- list("nacp_cu01", "nacp_cu02", "nacp_cu03", "nacp_cu04", "nacp_cu05", "nacp_cu06", 
                          "nacp_cu07", "nacp_cu08", "nacp_cu09")
other_units <- list("nacp_aq02u", "nacp_aq03l", "nacp_aq04p", "nacp_aq05a", "nacp_aq06m", "nacp_aq07m", 
                      "nacp_aq08m", "nacp_aq09p", "nacp_aq10p", "nacp_cu10b")

all_units <- list("nacp_aq02u", "nacp_aq03l", "nacp_aq04p", "nacp_aq05a", "nacp_aq06m", "nacp_aq07m", 
                    "nacp_aq08m", "nacp_aq09p", "nacp_aq10p", "nacp_cu10b", "nacp_cu01", "nacp_cu02", 
                    "nacp_cu03", "nacp_cu04", "nacp_cu05", "nacp_cu06", "nacp_cu07", "nacp_cu08", "nacp_cu09")


test_mod <- nacp_class_mod %>% 
  rowwise() %>% 
  mutate(status = 
           ifelse(is.na(aquifer), NA, 
                  ifelse(aquifer %in% c("nacp_cu01", "surf"), "unconfined", 
                  ifelse(aquifer %in% all_units & !is.na(confining_units), "confined", "unconfined"))))

test_mod <- nacp_class_mod %>% 
  rowwise() %>% 
  mutate(sum_thick = sum(abs(nacp_cu01), abs(nacp_cu02), abs(nacp_cu03), abs(nacp_cu04), abs(nacp_cu05),
                         abs(nacp_cu06), abs(nacp_cu07), abs(nacp_cu08), abs(nacp_cu09), na.rm = TRUE)) %>% 
  mutate(status = 
           ifelse(is.na(aquifer), NA, 
                  ifelse(aquifer %in% c("nacp_cu01", "surf"), "unconfined", 
                  ifelse(aquifer %in% all_units &  sum_thick > 0, "confined", "unconfined"))))


```

#### 1900 Data

Just confining unit above

```{r}
# Confining unit criteria 
# Must have confining unit above to be considered a confined well 
# Can include confining units (except the uppermost, VKBG) 

confined_criteria_1900 <- me_class_1900 %>% 
  rowwise() %>% 
  mutate(status = 
           ifelse(is.na(aquifer), NA,
           ifelse(aquifer %in% c("mrva", "vkbg"), "unconfined", 
           ifelse(aquifer == "ucaq" & is.na(vkbg_surf_1), "unconfined",
           ifelse(aquifer == "mccu" & is.na(vkbg_surf_1), "unconfined", 
           ifelse(aquifer == "mcaq" & !is.na(mccu_surf_1) | !is.na(vkbg_surf_1), "confined",
           ifelse(aquifer == "lccu" & !is.na(mccu_surf_1) | !is.na(vkbg_surf_1), "confined",
           ifelse(aquifer == "lcaq" & !is.na(lccu_surf_1) | !is.na(mccu_surf_1) | !is.na(vkbg_surf_1), "confined",
           ifelse(aquifer == "mwaq" & !is.na(lccu_surf_1) | !is.na(mccu_surf_1) | !is.na(vkbg_surf_1), "confined", 
           ifelse(aquifer == "lwaq" & !is.na(lccu_surf_1) | !is.na(mccu_surf_1) | !is.na(vkbg_surf_1), "confined", 
           ifelse(aquifer == "mdwy" & !is.na(lccu_surf_1) | !is.na(mccu_surf_1) | !is.na(vkbg_surf_1), "confined", "unconfined")))))))))))

```

### Accuracy check with USGS Confined/Unconfined 

#### Modern data only 

```{r}
# Check to see accuracy of confined/unconfined 

me_modern_check <- confined_criteria_mod %>% 
  rowwise() %>% 
  mutate(check =
           ifelse(status == "confined" & code %in% c("Confined single aquifer", "Confined multiple aquifers"), "true_c", 
           ifelse(status == "confined" & is.na(code), "no_data_c", 
           ifelse(status == "confined" & code %in% c("Unconfined single aquifer", "Unconfined multiple aquifer"), "wrong_c", 
           ifelse(status == "unconfined" & is.na(code), "no_data_uc",
           ifelse(status == "unconfined" & code %in% c("Unconfined single aquifer", "Unconfined multiple aquifer"), "true_uc", 
           ifelse(status == "unconfined" & code %in% c("Confined single aquifer", "Confined multiple aquifers"), "wrong_uc", 
                                                  NA)))))))

# Summary 
summary_check <- me_modern_check %>% 
  group_by(check) %>% 
  count(check)

# Checked wrong data (commented out)

# Isolate wrong confined 

# confined_wrong <- me_modern_check %>% 
#   filter(check == "wrong_c")
# 
# write_tsv(confined_wrong, here::here("output_data", "me", "confined_wrong.txt"))

```

Make table from summary of error/unconfined-confined checking --working on this, not complete 05/02/22

```{r}
error_table <- summary_check %>% 
  filter(!is.na(check)) %>%
  mutate(total_n = colSums(summary_check[,-1])) 

```

### Make summary tables 

To count confined, unconfined, artesian by aquifer unit 

```{r}
# Final summaries of "correct" data 

# Modern data

# Confined/unconfined and artesian by aquifer unit

summary_mod_final_art <- me_modern_check %>% 
  filter(!check %in% c("wrong_uc", "wrong_c")) %>% 
  group_by(aquifer, status, artesian) %>% 
  count(aquifer) %>% 
  filter(!is.na(status))

# Pivot wider 

mod_final_wide <- pivot_wider(summary_mod_final_art, 
                          names_from = c(status, artesian), 
                          values_from = n) 

# Write to file 
write_csv(mod_final_wide, here::here("output_data", "me", "mod_final_table.txt"))
  

# 1900s data

# Confined/unconfined by aquifer unit 
summary_1900_final <- confined_criteria_1900 %>% 
  group_by(aquifer, status, artesian) %>% 
  count(aquifer) 

# Pivot wider 

early1900s_final_wide <- pivot_wider(summary_1900_final, 
                          names_from = c(status, artesian), 
                          values_from = n) 

# Write to file 
write_csv(early1900s_final_wide, here::here("output_data", "me", "early1900s_final_table.txt"))

```

Fraction of confined wells to depth 

```{r}
# Data frame for plots 
ggplot_modern <- me_modern_check %>% 
  filter(!check %in% c("wrong_c", "wrong_uc")) %>% 
  filter(!is.na(check))

# Violin plot comparing confined, unconfined and USGS data/no data 
ggplot(ggplot_modern, 
       aes(x = status, 
           y = well_depth_va, 
           fill = check)) + 
  geom_violin()

```
Can't figure out binning...how can this be so hard? (05/02/22) 

```{r}
# # Binned data frame (~10 m intervals)
# 
# ggplot_mod_bin <- ggplot_modern %>% 
#   ungroup() %>% 
#   mutate(depth_bin = dplyr::ntile(well_depth_va, 33)) %>% 
#   mutate(confined_num = ifelse(status == "unconfined", 0, 1)) %>% 
#   group_by(depth_bin) %>% 
#   add_count(depth_bin)
#   
# ggplot_mod_bin2 <- ggplot_modern %>% 
#   ungroup() %>% 
#   mutate(depth_bin = cut(well_depth_va, breaks = c(0, 33, 66, 99, ))
#          
# test <- ggplot_modern %>% 
#   ungroup() %>% 
#   mutate(depth_bin = 
#            case_when(well_depth_va <= 33 ~"1", 
#                      well_depth_va <= 66 ~"2", 
#                      well_depth_va <= 99 ~"3", 
#                      TRUE ~"NA"))
# 
# 
# 
# %>% 
#   mutate(confined_num = ifelse(status == "unconfined", 0, 1)) %>% 
#   group_by(depth_bin) %>% 
#   add_count(depth_bin)
# 
# breaks = seq(33 - )

```


#### Comparison of artesian conditions (confined wells only) 

1900 to 2010-2020


```{r}
# All aquifers that are confined by our criteria, excluding "incorrect" ones (Modern) with USGS correction 

# Modern wells 
me_confined_mod <- me_modern_check %>% 
  filter(check %in% c("true_c", "no_data_c")) %>% 
  mutate(artesian = 
           ifelse(median < 0, 1, 0))

# Write as tsv 
write_csv(me_confined_mod, here::here("output_data", "me", "me_confined_mod.txt"))

# 1900 data 
me_confined_1900 <- confined_criteria_1900 %>% 
  filter(status == "confined") 

# Write as tsv 
write_csv(me_confined_1900, here::here("output_data", "me", "me_confined_historical.txt"))

```
