---
title: "NACP Project--Well Classification"
author: "Annette Hilton"
date: "12/14/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, error = FALSE)
```

# Introduction

This project is an examination of early 1900s (~1890-1906) groundwater conditions in the North Atlantic Coastal Plain (NACP) as compared to present day (2010-2021).

The purpose of this Rmd is to: 

*Pre-Rmd*: Data were processed in ArcGIS for DEM value 

1) Prep data for input to ArcGIS (for hydrogeological analysis) 
2) After ArcGIS processing: 

1) Determine well-aquifer classification 
2) Compare artesian conditions 
  

## Attach Packages and Data 

```{r}
# Attach packages 

library(plyr) # Be sure to load `plyr()` first, otherwise other functions in tidyverse break! 
library(tidyverse)
library(here)
library(janitor)
library(naniar)

# Disable scientific notation 

options(scipen=999)
```

```{r}
# Modern data 
# Read in modern USGS data w/ DEM 
dem_usgs_modern <- readr::read_csv(here::here("data", "dem", "dem_usgs_modern.csv")) 

# Read in modern USGS data full file (from Rmd `modern_data_cleaning.Rmd`)
usgs_modern <- readr::read_tsv(here::here("output_data", "usgs_modern.txt"))

```

### Join DEM files with full data files 

```{r}
# Join modern 

modern_join <- usgs_modern %>% 
  full_join(dem_usgs_modern, by = "site_no")

```

## Data Analysis (Pre-Arc)

### Refine dataset for the NACP  

```{r}
# Only keep well data for states in FL: 
# New York, New Jersey, Delaware, Maryland, Virginia, North Carolina

nacp <- modern_join %>% 
  filter(id.x %in% c("ny", "nj", "de", "md", "va", "nc")) 

```


### Prep data for import into ArcGIS 

```{r}
# Write to text file to then export to ArcGIS

write_tsv(nacp, here::here("output_data", "nacp", "nacp_modern_toclassify.txt"))
  
```


## ArcGIS Data Analysis 

The following steps were performed in ArcGIS: 

Hydrogeological data: 
Arcfile = "nacp" 

1. Import USGS NACP geologic data 
2. Import USGS wells (text file from analysis above; 'nacp_modern_toclassify.txt') and early 1900s data (early1900s_dem_wgs84_final.txt)
3. Use tool "Extract multi values to points" to determine well location intersection with geological raster layers
4. Export resulting well data as a text file 

## Data Analysis (Post-Arc)

### Hydrogeological data 

```{r}
# Read in modern data file from Arc 

nacp_mod_fromarc <- readr::read_csv(here::here("data", "nacp", "nacp_mod_classified.txt"))

# Read in early 1900s data file from Arc 

nacp_early1900s_fromarc <- readr::read_csv(here::here("data", "nacp", "nacp_historical_classified.txt"))

# Read in meta file for early 1900s 

early1900s_meta <- readr::read_tsv(here::here("output_data", "early1900s_arc.txt"))

```

Tidy data 
**Note: ArcGIS somehow messes up data (water level, well depth)--from DEM, only keep the site ID and the DEM value. For 1900s data, join with old file here. 
Modern file already joined above. 

```{r}
# Basic data tidying 
# Create `na_strings` to indicate pesky NA values
# Replace NA numeric indicators with "NA" 
# Rename long column names with their short hydrogeologic formation 

# Modern data

na_strings <- c("-9999", "-9999.00", "-9999.000", "-9999.0000", "-9999.00000", "-9999.000000")

nacp_mod_tidy <- nacp_mod_fromarc %>% 
  clean_names() %>%  
  replace_with_na_all(condition = ~.x %in% na_strings) %>% 
  select(-oid) %>% 
  rename(nacp_aq01s = nacp_aq01surf, 
         nacp_aq02u = nacp_aq02upch, 
         nacp_aq03l = nacp_aq03loch, 
         nacp_aq04p = nacp_aq04pipt, 
         nacp_aq05a = nacp_aq05aq, 
         nacp_aq06m = nacp_aq06moml, 
         nacp_aq07m = nacp_aq07mtwn, 
         nacp_aq08m = nacp_aq08mgty, 
         nacp_aq09p = nacp_aq09popt, 
         nacp_aq10p = nacp_aq10popx, 
         nacp_cu10b = nacp_cu10bsmt)


# 1900s data 

nacp_early1900s_tidy <- nacp_early1900s_fromarc %>% 
  clean_names() %>% 
  select(-oid, -oid1)  %>%  
  replace_with_na_all(condition = ~.x %in% na_strings)

# Join with meta file 

nacp_early1900s_join <- nacp_early1900s_tidy %>% 
  full_join(early1900s_meta, by = "id") %>% 
  clean_names() %>% 
  select(-latitude_x:-artesian_x)

```


### NACP Aquifer Information 

Hydrogeologic Layer Surfaces:

- Surficial aquifer (nacp_aq01_surf) == (nacp_aq01s)
- Upper Chesapeake confining unit (nacp_cu01)
- Upper Chesapeake aquifer (nacp_aq02upch) == (nacp_aq02u)
- Lower Chesapeake confining unit (nacp_cu02)
- Lower Chesapeake aquifer (nacp_aq03loch) == (nacp_aq03l)
- Calvert confining unit (nacp_cu03)
- Piney Point aquifer (nacp_aq04pipt) == (nacp_aq04p)
- Nanjemoy-Marlboro confining unit (nacp_cu04)
- Aquia aquifer (nacp_aq05aq) == (nacp_aq05a)
- Monmouth-Mount Laurel confining unit (nacp_cu05)
- Monmouth-Mount Laurel aquifer (nacp_aq06moml) == (nacp_aq06m)
- Matawan confining unit (nacp_cu06)
- Matawan aquifer (nacp_aq07mtwn) == (nacp_aq07m)
- Magothy confining unit (nacp_cu07)
- Magothy aquifer (nacp_aq08mgty) == (nacp_aq08m)
- Potomac confining unit (nacp_cu08)
- Potomac-Patapsco aquifer (nacp_aq09popt) == (nacp_aq09p)
- Potomac-Patuxent confining unit (nacp_cu09)
- Potomac-Patuxent aquifer (nacp_aq10_popx) == (nacp_aq10_p)
- Basement (nacp_cu10bsmt) == (nacp_cu10b)

Unit Range (ft): 

- Surficial aquifer: 481 (-308)
- Upper Chesapeake confining unit: 129 (-354) 
- Upper Chesapeake aquifer: 114 (-383)
- Lower Chesapeake confining unit: 150 (-850)
- Lower Chesapeake aquifer: 215 (-1007)
- Calvert confining unit: 236 (-1671)
- Piney Point aquifer: 92 (-1516)
- Nanjemoy-Marlboro confining unit: 233 (-1720)
- Aquia aquifer: 228 (-1323)
- Monmouth-Mount Laurel confining unit: 214 (-1981) 
- Monmouth-Mount Laurel aquifer: 143 (-2377) 
- Matawan confining unit: 118 (-2439)
- Matawan aquifer: 62 (-2501) 
- Magothy confining unit: 130 (-2532) 
- Magothy aquifer: 187 (-2995) 
- Potomac confining unit: 198 (-3380)
- Potomac-Patapsco aquifer: 229 (-3602) 
- Potomac-Patuxent confining unit: 408 (-5373)
- Potomac-Patuxent aquifer: 408 (-5373)
- Basement: 400 (-9031) 


### Aquifer analysis 

- Find well bottom 
- Remove observations that do not fall within NACP (all NAs) 

```{r}
# Add a column that is elevation minus well depth
# Add column to remove rows if nacp_aq01s:nacp_cu10b are all NAs (does not intersect with NACP) 

# Modern data 

nacp_analysis_mod <- nacp_mod_tidy %>% 
  mutate(topo_ft = rastervalu * 3.28084) %>% 
  mutate(well_bottom = topo_ft - well_depth_va) %>% 
   mutate(keep = 
           ifelse(is.na(nacp_aq01s) & is.na(nacp_cu01) & is.na(nacp_aq02u) 
                  & is.na(nacp_cu02) & is.na(nacp_aq03l) & is.na(nacp_cu03)
                  & is.na(nacp_aq04p) & is.na(nacp_cu04) & is.na(nacp_aq05a)
                  & is.na(nacp_cu05) & is.na(nacp_aq06m) & is.na(nacp_cu06)
                  & is.na(nacp_aq07m) & is.na(nacp_cu07) & is.na(nacp_aq08m)
                  & is.na(nacp_cu08) & is.na(nacp_aq09p) & is.na(nacp_cu09) 
                  & is.na(nacp_aq10p) & is.na(nacp_cu10b), "NA", "keep")) %>% 
  filter(!keep == "NA")

# 1900s data 

nacp_analysis_1900 <- nacp_early1900s_join %>% 
  mutate(topo_ft = ned10m_bil * 3.28084) %>% 
  mutate(well_bottom = topo_ft - well_depth_ft) %>% 
   mutate(keep = 
           ifelse(is.na(nacp_aq01s) & is.na(nacp_cu01) & is.na(nacp_aq02u) 
                  & is.na(nacp_cu02) & is.na(nacp_aq03l) & is.na(nacp_cu03)
                  & is.na(nacp_aq04p) & is.na(nacp_cu04) & is.na(nacp_aq05a)
                  & is.na(nacp_cu05) & is.na(nacp_aq06m) & is.na(nacp_cu06)
                  & is.na(nacp_aq07m) & is.na(nacp_cu07) & is.na(nacp_aq08m)
                  & is.na(nacp_cu08) & is.na(nacp_aq09p) & is.na(nacp_cu09) 
                  & is.na(nacp_aq10p) & is.na(nacp_cu10b), "NA", "keep")) %>% 
  filter(!keep == "NA")
  
```

#### Classify each well to an aquifer unit 

Process: 

If well bottom is greater than second unit (top), then it falls within the first unit (second unit top is the bottom of the first unit). 

Well bottom < nacp_aq01s & well bottom > max(nacp_cu01:nacp_cu10b) = “nacp_aq01s”
Well bottom < nacp_cu01 & well bottom > max(nacp_aq02u:nacp_cu10b) = “nacp_cu01”
Well bottom < nacp_aq02u & well bottom > max(nacp_cu02:nacp_cu10b) = “nacp_aq02u”
Well bottom < nacp_cu02 & well bottom > max(nacp_aq03l:nacp_cu10b) = “nacp_cu02” 
Well bottom < nacp_aq03l & well bottom > max(nacp_cu03:nacp_cu10b) = “nacp_aq03l”
Well bottom < nacp_cu03 & well bottom > max(nacp_aq04p:nacp_cu10b) = “nacp_cu03”
Well bottom < nacp_aq04p & well bottom > max(nacp_cu04:nacp_cu10b) = “nacp_aq04p” 
Well bottom < nacp_cu04 & well bottom > max(nacp_aq05a:nacp_cu10b) = “nacp_cu04” 
Well bottom < nacp_aq05a & well bottom > max(nacp_cu05:nacp_cu10b) = “nacp_aq05a” 
Well bottom < nacp_cu05 & well bottom > max(nacp_aq06m:nacp_cu10b) = “nacp_cu05” 
Well bottom < nacp_aq06m & well bottom > max(nacp_cu06:nacp_cu10b) = “nacp_aq06m” 
Well bottom < nacp_cu06 & well bottom > max(nacp_aq07m:nacp_cu10b) = “nacp_cu06”
Well bottom < nacp_aq07m & well bottom > max(nacp_cu07:nacp_cu10b) = “nacp_aq07m” 
Well bottom < nacp_cu07 & well bottom > max(nacp_aq08m:nacp_cu10b) = “nacp_cu07”
Well bottom < nacp_aq08m & well bottom > max(nacp_cu08:nacp_cu10b) = “nacp_aq08m”  
Well bottom < nacp_cu08 & well bottom > max(nacp_aq09p:nacp_cu10b) = “nacp_cu08”
Well bottom < nacp_aq09p & well bottom > max(nacp_cu09:nacp_cu10b) = “nacp_aq09p”
Well bottom < nacp_cu09 & well bottom > max(nacp_aq10p:nacp_cu10b) = “nacp_cu09”
Well bottom < nacp_aq10p & well bottom > nacp_cu10b = “nacp_aq10p”  
Well bottom < nacp_cu10b = “nacp_cu10b” 



```{r}
# Code for assigning each well to an aquifer unit 
# Not elegant but currently works! 

# Modern data 

nacp_class_mod <- nacp_analysis_mod %>% 
  rowwise() %>%
  mutate(aquifer = 
        ifelse(well_bottom < topo_ft & well_bottom >= max(nacp_cu01, nacp_aq02u, nacp_cu02, 
                                                            nacp_aq03l, nacp_cu03, nacp_aq04p, 
                                                            nacp_cu04, nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "surf", 
        ifelse(well_bottom < nacp_cu01 & well_bottom >= max(nacp_aq02u, nacp_cu02, 
                                                            nacp_aq03l, nacp_cu03, nacp_aq04p, 
                                                            nacp_cu04, nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE),"nacp_cu01",
        ifelse(well_bottom < nacp_aq02u & well_bottom >= max(nacp_cu02, 
                                                            nacp_aq03l, nacp_cu03, nacp_aq04p, 
                                                            nacp_cu04, nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq02u", 
        ifelse(well_bottom < nacp_cu02 & well_bottom >= max(nacp_aq03l, nacp_cu03, nacp_aq04p, 
                                                            nacp_cu04, nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu02",
        ifelse(well_bottom < nacp_aq03l & well_bottom >= max(nacp_cu03, nacp_aq04p, 
                                                            nacp_cu04, nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq03l", 
        ifelse(well_bottom < nacp_cu03 & well_bottom >= max(nacp_aq04p, 
                                                            nacp_cu04, nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu03", 
        ifelse(well_bottom < nacp_aq04p & well_bottom >= max(nacp_cu04, nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq04p",
        ifelse(well_bottom < nacp_cu04 & well_bottom >= max(nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu04",
        ifelse(well_bottom < nacp_aq05a & well_bottom >= max(nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq05a",
        ifelse(well_bottom < nacp_cu05 & well_bottom >= max(nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu05", 
        ifelse(well_bottom < nacp_aq06m & well_bottom >= max(nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq06m",
        ifelse(well_bottom < nacp_cu06 & well_bottom >= max(nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu06",
        ifelse(well_bottom < nacp_aq07m & well_bottom >= max(nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq07m",
        ifelse(well_bottom < nacp_cu07 & well_bottom >= max(nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu07",
        ifelse(well_bottom < nacp_aq08m & well_bottom >= max(nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq08m",
        ifelse(well_bottom < nacp_cu08 & well_bottom >= max(nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu08",
        ifelse(well_bottom < nacp_aq09p & well_bottom >= max(nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq09p",
        ifelse(well_bottom < nacp_cu09 & well_bottom >= max(nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu09",
        ifelse(well_bottom < nacp_aq10p & well_bottom >= nacp_cu10b, "nacp_aq10p",
        ifelse(well_bottom < nacp_cu10b, "nacp_cu10b", NA)))))))))))))))))))))


# 1900 data 
nacp_class_1900 <- nacp_analysis_1900 %>% 
  rowwise() %>%
  mutate(aquifer = 
        ifelse(well_bottom < topo_ft & well_bottom >= max(nacp_cu01, nacp_aq02u, nacp_cu02, 
                                                            nacp_aq03l, nacp_cu03, nacp_aq04p, 
                                                            nacp_cu04, nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "surf", 
        ifelse(well_bottom < nacp_cu01 & well_bottom >= max(nacp_aq02u, nacp_cu02, 
                                                            nacp_aq03l, nacp_cu03, nacp_aq04p, 
                                                            nacp_cu04, nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE),"nacp_cu01",
        ifelse(well_bottom < nacp_aq02u & well_bottom >= max(nacp_cu02, 
                                                            nacp_aq03l, nacp_cu03, nacp_aq04p, 
                                                            nacp_cu04, nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq02u", 
        ifelse(well_bottom < nacp_cu02 & well_bottom >= max(nacp_aq03l, nacp_cu03, nacp_aq04p, 
                                                            nacp_cu04, nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu02",
        ifelse(well_bottom < nacp_aq03l & well_bottom >= max(nacp_cu03, nacp_aq04p, 
                                                            nacp_cu04, nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq03l", 
        ifelse(well_bottom < nacp_cu03 & well_bottom >= max(nacp_aq04p, 
                                                            nacp_cu04, nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu03", 
        ifelse(well_bottom < nacp_aq04p & well_bottom >= max(nacp_cu04, nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq04p",
        ifelse(well_bottom < nacp_cu04 & well_bottom >= max(nacp_aq05a, nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu04",
        ifelse(well_bottom < nacp_aq05a & well_bottom >= max(nacp_cu05, 
                                                            nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq05a",
        ifelse(well_bottom < nacp_cu05 & well_bottom >= max(nacp_aq06m, nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu05", 
        ifelse(well_bottom < nacp_aq06m & well_bottom >= max(nacp_cu06, nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq06m",
        ifelse(well_bottom < nacp_cu06 & well_bottom >= max(nacp_aq07m, 
                                                            nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu06",
        ifelse(well_bottom < nacp_aq07m & well_bottom >= max(nacp_cu07, nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq07m",
        ifelse(well_bottom < nacp_cu07 & well_bottom >= max(nacp_aq08m, nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu07",
        ifelse(well_bottom < nacp_aq08m & well_bottom >= max(nacp_cu08, 
                                                            nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq08m",
        ifelse(well_bottom < nacp_cu08 & well_bottom >= max(nacp_aq09p, nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu08",
        ifelse(well_bottom < nacp_aq09p & well_bottom >= max(nacp_cu09, nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_aq09p",
        ifelse(well_bottom < nacp_cu09 & well_bottom >= max(nacp_aq10p, 
                                                            nacp_cu10b, na.rm = TRUE), "nacp_cu09",
        ifelse(well_bottom < nacp_aq10p & well_bottom >= nacp_cu10b, "nacp_aq10p",
        ifelse(well_bottom < nacp_cu10b, "nacp_cu10b", NA)))))))))))))))))))))

```

Summary of wells per aquifer unit 

```{r}
# Summary of wells per aquifer unit 

# Modern data 
summarymod_nacp <- nacp_class_mod %>% 
  group_by(aquifer) %>% 
  count(aquifer) 


# 1900s data 

summary1900_nacp <- nacp_class_1900 %>% 
  group_by(aquifer) %>% 
  count(aquifer)



# join summaries 

full_summary <- summary1900_nacp %>% 
  full_join(summarymod_nacp, by = "aquifer") %>% 
  rename(historical = n.x, 
         modern = n.y)

```

#### Confined Well Criteria 

Confined aquifer units (nacp_aq02u, nacp_aq03l, nacp_aq04p, nacp_aq05a, nacp_aq06m, nacp_aq07m, nacp_aq08m, nacp_aq09p, nacp_aq10p): 

- Criteria: Must have at least 10 m (33 ft) of confining material above
- Code: Dependent on the aquifer, calculate the sum of the confining unit thickness above. If the sum of the confining unit thickness is >= 33 ft (10m), then "keep" the well. 


First, determine thickness of aquifer units 

```{r}
# Thickness of aquifer units 

# Modern data 
nacp_thickness_mod <- nacp_class_mod %>% 
  mutate(
    cu01_thick = nacp_cu01 - nacp_aq02u, 
    aq02u_thick = nacp_aq02u - nacp_cu02, 
    cu02_thick = nacp_cu02 - nacp_aq03l, 
    aq03l_thick = nacp_aq03l - nacp_cu03, 
    cu03_thick = nacp_cu03 - nacp_aq04p, 
    aq04p_thick = nacp_aq04p - nacp_cu04, 
    cu04_thick = nacp_cu04 - nacp_aq05a, 
    aq05a_thick = nacp_aq05a - nacp_cu05,  
    cu05_thick = nacp_cu05 - nacp_aq06m, 
    aq06m_thick = nacp_aq06m - nacp_cu06, 
    cu06_thick = nacp_cu06 - nacp_aq07m,
    aq07m_thick = nacp_aq07m - nacp_cu07, 
    cu07_thick = nacp_cu07 - nacp_aq08m, 
    aq08m_thick = nacp_aq08m - nacp_cu08, 
    cu08_thick = nacp_cu08 - nacp_aq09p, 
    aq09p_thick = nacp_aq09p - nacp_cu09, 
    cu09_thick = nacp_cu09 - nacp_aq10p, 
    aq10p_thick = nacp_aq10p - nacp_cu10b
  )

# 1900 data

nacp_thickness_1900 <- nacp_class_1900 %>% 
  mutate(
    cu01_thick = nacp_cu01 - nacp_aq02u, 
    aq02u_thick = nacp_aq02u - nacp_cu02, 
    cu02_thick = nacp_cu02 - nacp_aq03l, 
    aq03l_thick = nacp_aq03l - nacp_cu03, 
    cu03_thick = nacp_cu03 - nacp_aq04p, 
    aq04p_thick = nacp_aq04p - nacp_cu04, 
    cu04_thick = nacp_cu04 - nacp_aq05a, 
    aq05a_thick = nacp_aq05a - nacp_cu05,  
    cu05_thick = nacp_cu05 - nacp_aq06m, 
    aq06m_thick = nacp_aq06m - nacp_cu06, 
    cu06_thick = nacp_cu06 - nacp_aq07m,
    aq07m_thick = nacp_aq07m - nacp_cu07, 
    cu07_thick = nacp_cu07 - nacp_aq08m, 
    aq08m_thick = nacp_aq08m - nacp_cu08, 
    cu08_thick = nacp_cu08 - nacp_aq09p, 
    aq09p_thick = nacp_aq09p - nacp_cu09, 
    cu09_thick = nacp_cu09 - nacp_aq10p, 
    aq10p_thick = nacp_aq10p - nacp_cu10b
  )

```

Then, determine cumulative thickness & which wells meet criteria 

```{r}
# Only consider confining units for thickness 
# nacp_cu01, nacp_cu02, nacp_cu03, nacp_cu04, nacp_cu05, nacp_cu06, nacp_cu07, nacp_cu08, nacp_cu09


# Modern data 
nacp_cum_thickness_mod <- nacp_thickness_mod %>% 
  rowwise() %>% 
  mutate(cum_thick = 
        ifelse(aquifer == "surf", sum(cu01_thick, cu02_thick, cu03_thick, cu04_thick, 
                                            cu05_thick, cu06_thick, cu07_thick, cu08_thick, 
                                            cu09_thick, na.rm = TRUE), 
        ifelse(aquifer == "nacp_aq02u", sum(cu01_thick), 
        ifelse(aquifer == "nacp_aq03l", sum(cu01_thick, cu02_thick, na.rm = TRUE),
        ifelse(aquifer == "nacp_aq04p", sum(cu01_thick, cu02_thick, cu03_thick, na.rm = TRUE), 
        ifelse(aquifer == "nacp_aq05a", sum(cu01_thick, cu02_thick, cu03_thick, cu04_thick, na.rm = TRUE), 
        ifelse(aquifer == "nacp_aq06m", sum(cu01_thick, cu02_thick, cu03_thick, cu04_thick, 
                                            cu05_thick, na.rm = TRUE),
        ifelse(aquifer == "nacp_aq07m", sum(cu01_thick, cu02_thick, cu03_thick, cu04_thick, 
                                            cu05_thick, cu06_thick, na.rm = TRUE),
        ifelse(aquifer == "nacp_aq08m", sum(cu01_thick, cu02_thick, cu03_thick, cu04_thick, 
                                            cu05_thick, cu06_thick, cu07_thick, na.rm = TRUE),
        ifelse(aquifer == "nacp_aq09p", sum(cu01_thick, cu02_thick, cu03_thick, cu04_thick, 
                                            cu05_thick, cu06_thick, cu07_thick, cu08_thick, na.rm = TRUE),
        ifelse(aquifer == "nacp_aq10p", sum(cu01_thick, cu02_thick, cu03_thick, cu04_thick, 
                                            cu05_thick, cu06_thick, cu07_thick, cu08_thick, 
                                            cu09_thick, na.rm = TRUE),
               NA))))))))))) %>% 
  mutate(keep = 
           ifelse(cum_thick >= 33, "keep", NA))


# 1900 data 
nacp_cum_thickness_1900 <- nacp_thickness_1900 %>% 
  rowwise() %>% 
  mutate(cum_thick = 
        ifelse(aquifer == "surf", sum(cu01_thick, cu02_thick, cu03_thick, cu04_thick, 
                                            cu05_thick, cu06_thick, cu07_thick, cu08_thick, 
                                            cu09_thick, na.rm = TRUE), 
        ifelse(aquifer == "nacp_aq02u", sum(cu01_thick), 
        ifelse(aquifer == "nacp_aq03l", sum(cu01_thick, cu02_thick, na.rm = TRUE),
        ifelse(aquifer == "nacp_aq04p", sum(cu01_thick, cu02_thick, cu03_thick, na.rm = TRUE), 
        ifelse(aquifer == "nacp_aq05a", sum(cu01_thick, cu02_thick, cu03_thick, cu04_thick, na.rm = TRUE), 
        ifelse(aquifer == "nacp_aq06m", sum(cu01_thick, cu02_thick, cu03_thick, cu04_thick, 
                                            cu05_thick, na.rm = TRUE),
        ifelse(aquifer == "nacp_aq07m", sum(cu01_thick, cu02_thick, cu03_thick, cu04_thick, 
                                            cu05_thick, cu06_thick, na.rm = TRUE),
        ifelse(aquifer == "nacp_aq08m", sum(cu01_thick, cu02_thick, cu03_thick, cu04_thick, 
                                            cu05_thick, cu06_thick, cu07_thick, na.rm = TRUE),
        ifelse(aquifer == "nacp_aq09p", sum(cu01_thick, cu02_thick, cu03_thick, cu04_thick, 
                                            cu05_thick, cu06_thick, cu07_thick, cu08_thick, na.rm = TRUE),
        ifelse(aquifer == "nacp_aq10p", sum(cu01_thick, cu02_thick, cu03_thick, cu04_thick, 
                                            cu05_thick, cu06_thick, cu07_thick, cu08_thick, 
                                            cu09_thick, na.rm = TRUE),
               NA))))))))))) %>% 
  mutate(keep = 
           ifelse(cum_thick >= 33, "keep", NA))
```


### Separate each aquifer/unit and confined 

Confined 1900 to 2010-2020 

Modern n = 89
1900s n = 1160

```{r}
# All aquifers that are confined by our criteria  

# Modern data 

nacp_confined_mod <- nacp_cum_thickness_mod %>% 
  filter(keep == "keep" & !aquifer == "surf") %>% 
  mutate(artesian = 
           ifelse(lev_va < 0, 1, 0))

# write file for arc 

write_tsv(nacp_confined_mod, here::here("output_data", "nacp", "modern_confined_nacp.txt"))

# 1900 data 

nacp_confined_1900 <- nacp_cum_thickness_1900 %>% 
  filter(keep == "keep" & !aquifer == "surf")

# write file for arc 

write_tsv(nacp_confined_1900, here::here("output_data", "nacp", "historical_confined_nacp.txt"))

```


